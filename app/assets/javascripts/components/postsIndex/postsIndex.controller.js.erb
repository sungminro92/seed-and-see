angular
  .module('seedAndSee')
  .controller('PostsIndexController', PostsIndexController);

PostsIndexController.$inject = ['$stateParams','postsService','usersService'];

function PostsIndexController($stateParams, postsService, usersService) {
  var vm = this;

  vm.posts = [];
  vm.currentUser = {};
  // vm.userId = $stateParams.userId
  vm.sortBy = sortBy;
  vm.limit = 9;
  vm.loadMore = loadMore;
  activate();
  hideLaodMore();

  function activate() {
    $(window).resize(function() {
      windowWidth = $(window).innerWidth();
      if (windowWidth <= 500) {
      $('.order-by-wrap').hide();
      } else {
      $('.order-by-wrap').show();
      }
    })
  };

  function hideLaodMore() {
    if (vm.posts.length <= 9) {
      $('.load-more').hide();
    }
  }

  function loadMore() {
    vm.limit = vm.posts.length
  };

	postsService
  	.getPosts() 
  	.then(function(res) {
      console.log(res);
	    vm.posts = res.data.posts
      vm.currentUser = res.data.currentUser
      // posts;
      // vm.currentUser = res.data.currentUser;
	});

  vm.propertyName = 'created_at';
  vm.reverse = true;

  function sortBy(propertyName) {
    vm.reverse = (vm.propertyName === propertyName) ? !vm.reverse : false;
    vm.propertyName = propertyName;
  };

}
